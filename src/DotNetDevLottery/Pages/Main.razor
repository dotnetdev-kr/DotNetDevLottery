@page "/"
@implements IAsyncDisposable
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime
@inject IEventService EventService
@using DotNetDevLottery.Components;

<div class="header">
    <h1 class="title">ğŸ‰ ê²½í’ˆ ì¶”ì²¨ í”„ë¡œê·¸ë¨</h1>
    <FluentButton Appearance="Appearance.Lightweight" OnClick="@(() => settingsDialog?.Show())">
        âš™ï¸ ë³¼ ë””ìì¸ ì„¤ì •
    </FluentButton>
</div>

<div class="container">
        <FluentStack Orientation="Orientation.Horizontal" HorizontalAlignment="HorizontalAlignment.Center" Wrap="true"
            HorizontalGap="8" class="event-company">
            @foreach (var eventInfo in EventService.EventInfos.Select((value, index) => new { value, index }))
            {
                <FluentButton
                    Appearance="@(selectedEventCompanyIndex == eventInfo.index ? Appearance.Accent : Appearance.Neutral)"
                    OnClick="@(() => OnClickIndexButton(eventInfo.index))">
                    @eventInfo.value.name
                </FluentButton>
            }
        </FluentStack>
    <div @ref="dropzoneElement" class="file-dropzone">
        @if (targetFile == null)
        {
            <span>
                íŒŒì¼ì„ ëŒì–´ë‹¤ê°€ ë†“ì•„ì£¼ì„¸ìš”!
            </span>
        }
        else
        {
            <span class="file-dropzone__filename">
                @targetFile.Name
            </span>
        }
        <FluentButton Appearance="Appearance.Accent" OnClick="OnClickFileButton">
            í˜¹ì€ íŒŒì¼ ì§ì ‘ ì°¾ì•„ë³´ê¸°
        </FluentButton>
        <InputFile type="file" @ref="inputFileElement" class="file-dropzone__input" OnChange="@OnInputFileInput" />
    </div>
    @if (isSecondFilterOpened)
    {
        <div>
            <div class="form-row">
                @foreach (var groupName in groupNames.Select((value, index) => new { value, index }).ToArray())
                {
                    var currentIndex = groupName.index;
                    <FluentCheckbox Value="@filterGroup[currentIndex]"
                        ValueChanged="@(newValue => { filterGroup[currentIndex] = newValue; StateHasChanged(); })"
                        Label="@groupName.value" />
                }
            </div>
            <div class="form-row">
                <FluentCheckbox @bind-Value="@filterCheckedIn" Label="ì²´í¬ì¸ í•œ ì‚¬ëŒë§Œ í¬í•¨" />
            </div>
            <div class="form-row">
                <FluentButton Appearance="Appearance.Accent" OnClick="OnClickGoNextPageButton">
                    ì´ë™
                </FluentButton>
            </div>
        </div>
    }
    else
    {
        <div class="button-row">
            <FluentButton Appearance="Appearance.Accent" Disabled="@isLoading" OnClick="OnClickNextButton">
                @(isLoading ? "ê°€ì ¸ì˜¤ëŠ” ì¤‘" : "ë‹¤ìŒ")
            </FluentButton>
        </div>
    }
</div>

<BallDesignSettingsDialog @ref="settingsDialog" />